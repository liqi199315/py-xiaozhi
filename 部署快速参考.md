# çº¿ä¸Šéƒ¨ç½²å¿«é€Ÿå‚è€ƒ

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆ5åˆ†é’Ÿéƒ¨ç½²ï¼‰

### 1. ä¸Šä¼ é¡¹ç›®åˆ°æœåŠ¡å™¨
```bash
# ä½¿ç”¨ scp æˆ– git
scp -r py-xiaozhi user@server:/opt/
# æˆ–
git clone <your-repo> /opt/py-xiaozhi
```

### 2. è¿è¡Œè‡ªåŠ¨éƒ¨ç½²è„šæœ¬
```bash
cd /opt/py-xiaozhi

# Linux/Mac
chmod +x deploy.sh
./deploy.sh

# Windows
deploy.bat
```

### 3. å¯åŠ¨æœåŠ¡
```bash
python main_web.py --skip-activation --web-host 0.0.0.0
```

**å®Œæˆï¼** è®¿é—® `http://æœåŠ¡å™¨IP:8080/index3.html`

---

## ğŸ“¦ æ ¸å¿ƒä¾èµ–ï¼ˆä»…6ä¸ªåŒ…ï¼‰

```bash
pip install aiohttp==3.12.13 websockets==11.0.3 colorlog==6.9.0 requests==2.32.3 python-dateutil==2.9.0.post0 beautifulsoup4==4.12.3
```

æˆ–ä½¿ç”¨ç²¾ç®€ç‰ˆï¼š
```bash
pip install -r requirements_web.txt
```

---

## ğŸ”‘ å¿…éœ€ç¯å¢ƒå˜é‡

```bash
export DOUBAO_APP_KEY="2785683478"
export DOUBAO_ACCESS_KEY="OHl7yBW1VI5M9f4oI26RDU-3xPtkAGZp"
export XIAOZHI_WEB_HOST="0.0.0.0"
export XIAOZHI_WEB_PORT="8080"
```

---

## ğŸ¯ ç”Ÿäº§éƒ¨ç½²ï¼ˆsystemdï¼‰

### 1. åˆ›å»ºæœåŠ¡æ–‡ä»¶
```bash
sudo nano /etc/systemd/system/xiaozhi-web.service
```

### 2. å¡«å…¥é…ç½®
```ini
[Unit]
Description=XiaoZhi Web Service
After=network.target

[Service]
Type=simple
User=your-username
WorkingDirectory=/opt/py-xiaozhi
Environment="PATH=/opt/py-xiaozhi/venv/bin"
Environment="DOUBAO_APP_KEY=2785683478"
Environment="DOUBAO_ACCESS_KEY=OHl7yBW1VI5M9f4oI26RDU-3xPtkAGZp"
ExecStart=/opt/py-xiaozhi/venv/bin/python main_web.py --skip-activation --web-host 0.0.0.0
Restart=always

[Install]
WantedBy=multi-user.target
```

### 3. å¯åŠ¨æœåŠ¡
```bash
sudo systemctl daemon-reload
sudo systemctl start xiaozhi-web
sudo systemctl enable xiaozhi-web
sudo systemctl status xiaozhi-web
```

---

## ğŸŒ Nginx åå‘ä»£ç†ï¼ˆå¯é€‰ï¼‰

```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://127.0.0.1:8080;
        proxy_set_header Host $host;
    }

    location /api/doubao-asr {
        proxy_pass http://127.0.0.1:8080;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
}
```

---

## ğŸ§ª æµ‹è¯•å‘½ä»¤

```bash
# æµ‹è¯•HTTP
curl http://localhost:8080/

# æµ‹è¯•é…ç½®æ¥å£
curl http://localhost:8080/api/config

# æŸ¥çœ‹æ—¥å¿—
tail -f logs/xiaozhi.log

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl status xiaozhi-web
```

---

## ğŸ”’ å®‰å…¨æ¸…å•

- [ ] ç§»é™¤ä»£ç ä¸­ç¡¬ç¼–ç çš„å‡­è¯
- [ ] ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨æ•æ„Ÿä¿¡æ¯
- [ ] é…ç½®é˜²ç«å¢™è§„åˆ™
- [ ] ä½¿ç”¨ HTTPSï¼ˆLet's Encryptï¼‰
- [ ] å®šæœŸæ›´æ–°ä¾èµ–åŒ…
- [ ] é…ç½®æ—¥å¿—è½®è½¬

---

## ğŸ“ å¸¸è§ç«¯å£

- **8080**: WebæœåŠ¡ï¼ˆé»˜è®¤ï¼‰
- **80**: HTTPï¼ˆNginxï¼‰
- **443**: HTTPSï¼ˆNginxï¼‰

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1: ç«¯å£è¢«å ç”¨
```bash
sudo lsof -i :8080
sudo kill -9 <PID>
```

### é—®é¢˜2: WebSocketè¿æ¥å¤±è´¥
- æ£€æŸ¥ Nginx WebSocket é…ç½®
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
- æ£€æŸ¥åç«¯æ—¥å¿—

### é—®é¢˜3: è±†åŒ…è¿æ¥å¤±è´¥
```bash
ping openspeech.bytedance.com
curl -I https://openspeech.bytedance.com
```

---

## ğŸ“š æ–‡æ¡£ç´¢å¼•

- **å®Œæ•´éƒ¨ç½²æŒ‡å—**: [éƒ¨ç½²æŒ‡å—.md](./éƒ¨ç½²æŒ‡å—.md)
- **è±†åŒ…ASRè¯´æ˜**: [è±†åŒ…ASRé›†æˆè¯´æ˜.md](./è±†åŒ…ASRé›†æˆè¯´æ˜.md)
- **å®Œæˆæ€»ç»“**: [è±†åŒ…ASRå®Œæˆæ€»ç»“.md](./è±†åŒ…ASRå®Œæˆæ€»ç»“.md)

---

**éœ€è¦å¸®åŠ©ï¼Ÿ** æŸ¥çœ‹å®Œæ•´çš„ [éƒ¨ç½²æŒ‡å—.md](./éƒ¨ç½²æŒ‡å—.md)
